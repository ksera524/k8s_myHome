# Âç≥ÂÆüË°åÂèØËÉΩ„Å™‰øùÂÆàÊÄßÊîπÂñÑ„Çø„Çπ„ÇØ

## üéØ Êú¨Êó•ÂÆüÊñΩÂèØËÉΩ„Å™ÊîπÂñÑ (2ÊôÇÈñì‰ª•ÂÜÖ)

### 1. „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞Âº∑Âåñ (30ÂàÜ)

#### ÂØæË±°„Éï„Ç°„Ç§„É´ (6ÂÄã)
```bash
automation/host-setup/setup-libvirt-sudo.sh
automation/scripts/common-validation.sh
automation/scripts/common-colors.sh
automation/scripts/argocd/github-auth-utils.sh
automation/scripts/common-ssh.sh
automation/scripts/common-sudo.sh
```

#### ÂÆüË°å„Ç≥„Éû„É≥„Éâ
```bash
# ‰∏ÄÊã¨„Åß„Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞ËøΩÂä†
for file in automation/host-setup/setup-libvirt-sudo.sh \
           automation/scripts/common-validation.sh \
           automation/scripts/common-colors.sh \
           automation/scripts/argocd/github-auth-utils.sh \
           automation/scripts/common-ssh.sh \
           automation/scripts/common-sudo.sh; do
  if [ -f "$file" ]; then
    # „Ç∑„Çß„Éê„É≥Ë°å„ÅÆÂæå„Å´ËøΩÂä†
    sed -i '1a\\nset -euo pipefail' "$file"
    echo "‚úÖ Updated: $file"
  fi
done
```

### 2. ÂÖ±ÈÄö„Ç®„É©„Éº„Éè„É≥„Éâ„É©„Éº‰ΩúÊàê (15ÂàÜ)

#### „Éï„Ç°„Ç§„É´‰ΩúÊàê: `automation/lib/error-handler.sh`
```bash
#!/bin/bash
set -euo pipefail

# „Ç∞„É≠„Éº„Éê„É´„Ç®„É©„Éº„Éè„É≥„Éâ„É©„Éº
readonly SCRIPT_NAME="${0##*/}"
readonly LOG_DIR="/var/log/k8s-myhome"
readonly ERROR_LOG="${LOG_DIR}/errors.log"

# „É≠„Ç∞„Éá„Ç£„É¨„ÇØ„Éà„É™‰ΩúÊàê
[[ -d "$LOG_DIR" ]] || mkdir -p "$LOG_DIR"

# „Ç®„É©„Éº„Éà„É©„ÉÉ„Éó
trap_error() {
    local exit_code=$?
    local line_no=$1
    local bash_lineno=$2
    local last_command=$3
    
    echo "================== ERROR ==================" | tee -a "$ERROR_LOG"
    echo "Script: $SCRIPT_NAME" | tee -a "$ERROR_LOG"
    echo "Exit Code: $exit_code" | tee -a "$ERROR_LOG"
    echo "Line: $line_no" | tee -a "$ERROR_LOG"
    echo "Command: $last_command" | tee -a "$ERROR_LOG"
    echo "Time: $(date '+%Y-%m-%d %H:%M:%S')" | tee -a "$ERROR_LOG"
    echo "==========================================" | tee -a "$ERROR_LOG"
    
    # „Çπ„Çø„ÉÉ„ÇØ„Éà„É¨„Éº„Çπ
    echo "Call Stack:" | tee -a "$ERROR_LOG"
    local frame=0
    while caller $frame | tee -a "$ERROR_LOG"; do
        ((frame++))
    done
    
    exit $exit_code
}

# „É™„Éà„É©„Ç§Ê©üËÉΩ
retry_with_backoff() {
    local max_attempts=${1:-3}
    local delay=${2:-5}
    local max_delay=${3:-60}
    shift 3
    local command=("$@")
    local attempt=0
    
    until [[ $attempt -ge $max_attempts ]]; do
        if "${command[@]}"; then
            return 0
        fi
        
        ((attempt++))
        echo "Attempt $attempt/$max_attempts failed. Retrying in ${delay}s..." >&2
        sleep "$delay"
        
        # Exponential backoff
        delay=$((delay * 2))
        [[ $delay -gt $max_delay ]] && delay=$max_delay
    done
    
    echo "Command failed after $max_attempts attempts: ${command[*]}" >&2
    return 1
}

# „Çø„Ç§„É†„Ç¢„Ç¶„ÉàÊ©üËÉΩ
run_with_timeout() {
    local timeout=$1
    shift
    
    timeout "$timeout" "$@" || {
        local exit_code=$?
        if [[ $exit_code -eq 124 ]]; then
            echo "Command timed out after ${timeout}s: $*" >&2
        fi
        return $exit_code
    }
}

# „Ç®„É©„Éº„Éà„É©„ÉÉ„ÉóË®≠ÂÆö
trap 'trap_error $LINENO $BASH_LINENO "$BASH_COMMAND"' ERR

# Export functions
export -f trap_error
export -f retry_with_backoff
export -f run_with_timeout
```

### 3. Ë®≠ÂÆö„Éï„Ç°„Ç§„É´Áµ±Âêà (20ÂàÜ)

#### „Éï„Ç°„Ç§„É´‰ΩúÊàê: `automation/config/environment.conf`
```bash
#!/bin/bash
# Global configuration file for k8s_myHome

# Network Configuration
readonly K8S_NETWORK="192.168.122.0/24"
readonly K8S_CONTROL_PLANE_IP="192.168.122.10"
readonly K8S_WORKER1_IP="192.168.122.11"
readonly K8S_WORKER2_IP="192.168.122.12"
readonly METALLB_IP_RANGE="192.168.122.100-192.168.122.150"
readonly HARBOR_IP="192.168.122.100"
readonly ARGOCD_IP="192.168.122.101"

# User Configuration
readonly K8S_USER="k8suser"
readonly K8S_USER_HOME="/home/${K8S_USER}"
readonly SSH_KEY="${K8S_USER_HOME}/.ssh/id_ed25519"

# Timeout Configuration
readonly DEFAULT_TIMEOUT="300s"
readonly KUBECTL_TIMEOUT="120s"
readonly HELM_TIMEOUT="300s"
readonly ARGOCD_SYNC_TIMEOUT="600s"

# Retry Configuration
readonly DEFAULT_RETRY_COUNT=3
readonly DEFAULT_RETRY_DELAY=5
readonly MAX_RETRY_DELAY=60

# Kubernetes Configuration
readonly K8S_VERSION="v1.29.0"
readonly K8S_CLUSTER_NAME="home-k8s"
readonly K8S_POD_NETWORK_CIDR="10.244.0.0/16"
readonly K8S_SERVICE_CIDR="10.96.0.0/12"

# Storage Configuration
readonly STORAGE_BASE="/data"
readonly NFS_SHARE="${STORAGE_BASE}/nfs-share"
readonly LOCAL_VOLUMES="${STORAGE_BASE}/local-volumes"

# Application Versions
readonly METALLB_VERSION="0.13.12"
readonly INGRESS_NGINX_VERSION="4.8.2"
readonly CERT_MANAGER_VERSION="1.13.3"
readonly ARGOCD_VERSION="5.51.6"
readonly HARBOR_VERSION="1.13.1"

# Harbor Configuration
readonly HARBOR_ADMIN_PASSWORD="Harbor12345"
readonly HARBOR_PROJECT="sandbox"
readonly HARBOR_URL="harbor.local"

# Log Configuration
readonly LOG_DIR="/var/log/k8s-myhome"
readonly LOG_LEVEL="${LOG_LEVEL:-INFO}"
readonly DEBUG="${DEBUG:-false}"
```

#### Êó¢Â≠ò„Çπ„ÇØ„É™„Éó„Éà„ÅÆÊõ¥Êñ∞‰æã
```bash
# Before (automation/platform/platform-deploy.sh)
CONTROL_PLANE_IP="192.168.122.10"
HARBOR_IP="192.168.122.100"

# After
source "$(dirname "$0")/../config/environment.conf"
# Â§âÊï∞„ÅØËá™ÂãïÁöÑ„Å´Âà©Áî®ÂèØËÉΩ
```

### 4. „É≠„Ç∞Ê©üËÉΩÁµ±‰∏Ä (15ÂàÜ)

#### „Éï„Ç°„Ç§„É´‰ΩúÊàê: `automation/lib/logger.sh`
```bash
#!/bin/bash
set -euo pipefail

# Source configuration
source "$(dirname "$0")/../config/environment.conf"

# „É≠„Ç∞„É¨„Éô„É´ÂÆöÁæ©
readonly LOG_LEVEL_ERROR=1
readonly LOG_LEVEL_WARN=2
readonly LOG_LEVEL_INFO=3
readonly LOG_LEVEL_DEBUG=4

# ÁèæÂú®„ÅÆ„É≠„Ç∞„É¨„Éô„É´
case "${LOG_LEVEL:-INFO}" in
    ERROR) CURRENT_LOG_LEVEL=$LOG_LEVEL_ERROR ;;
    WARN)  CURRENT_LOG_LEVEL=$LOG_LEVEL_WARN ;;
    INFO)  CURRENT_LOG_LEVEL=$LOG_LEVEL_INFO ;;
    DEBUG) CURRENT_LOG_LEVEL=$LOG_LEVEL_DEBUG ;;
    *)     CURRENT_LOG_LEVEL=$LOG_LEVEL_INFO ;;
esac

# „Ç´„É©„ÉºÂÆöÁæ©
if [[ -t 1 ]]; then
    readonly COLOR_RED='\033[0;31m'
    readonly COLOR_YELLOW='\033[0;33m'
    readonly COLOR_GREEN='\033[0;32m'
    readonly COLOR_BLUE='\033[0;34m'
    readonly COLOR_RESET='\033[0m'
else
    readonly COLOR_RED=''
    readonly COLOR_YELLOW=''
    readonly COLOR_GREEN=''
    readonly COLOR_BLUE=''
    readonly COLOR_RESET=''
fi

# „É≠„Ç∞„Éï„Ç°„Ç§„É´Ë®≠ÂÆö
readonly LOG_FILE="${LOG_DIR}/$(date +%Y%m%d).log"
[[ -d "$LOG_DIR" ]] || mkdir -p "$LOG_DIR"

# „É≠„Ç∞Âá∫ÂäõÈñ¢Êï∞
log() {
    local level=$1
    local level_name=$2
    local color=$3
    shift 3
    
    [[ $level -gt $CURRENT_LOG_LEVEL ]] && return 0
    
    local timestamp=$(date '+%Y-%m-%d %H:%M:%S')
    local message="[$timestamp] [$level_name] $*"
    
    # „Ç≥„É≥„ÇΩ„Éº„É´Âá∫ÂäõÔºà„Ç´„É©„Éº‰ªò„ÅçÔºâ
    echo -e "${color}${message}${COLOR_RESET}"
    
    # „Éï„Ç°„Ç§„É´Âá∫ÂäõÔºà„Ç´„É©„Éº„Å™„ÅóÔºâ
    echo "$message" >> "$LOG_FILE"
    
    # syslogÂá∫Âäõ
    if command -v logger &>/dev/null; then
        logger -t "k8s-myhome" -p "local0.${level_name,,}" "$*"
    fi
}

# „É≠„Ç∞„É¨„Éô„É´Âà•Èñ¢Êï∞
log_error() {
    log $LOG_LEVEL_ERROR "ERROR" "$COLOR_RED" "$@"
}

log_warn() {
    log $LOG_LEVEL_WARN "WARN" "$COLOR_YELLOW" "$@"
}

log_info() {
    log $LOG_LEVEL_INFO "INFO" "$COLOR_GREEN" "$@"
}

log_debug() {
    log $LOG_LEVEL_DEBUG "DEBUG" "$COLOR_BLUE" "$@"
}

# „Éó„É≠„Ç∞„É¨„ÇπË°®Á§∫
log_progress() {
    echo -ne "\r${COLOR_BLUE}[PROGRESS]${COLOR_RESET} $*"
}

log_progress_done() {
    echo -e "\r${COLOR_GREEN}[DONE]${COLOR_RESET} $*"
}

# Export functions
export -f log
export -f log_error
export -f log_warn
export -f log_info
export -f log_debug
export -f log_progress
export -f log_progress_done
```

### 5. ‰æùÂ≠òÈñ¢‰øÇ„ÉÅ„Çß„ÉÉ„Ç´„Éº (10ÂàÜ)

#### „Éï„Ç°„Ç§„É´‰ΩúÊàê: `automation/scripts/check-requirements.sh`
```bash
#!/bin/bash
set -euo pipefail

source "$(dirname "$0")/../lib/logger.sh"

# ÂøÖÈ†à„Ç≥„Éû„É≥„Éâ„É™„Çπ„Éà
declare -a REQUIRED_COMMANDS=(
    "kubectl:Kubernetes CLI"
    "terraform:Infrastructure as Code tool"
    "ansible-playbook:Ansible automation"
    "jq:JSON processor"
    "yq:YAML processor"
    "helm:Kubernetes package manager"
    "virsh:Virtualization management"
    "git:Version control"
)

# „Ç™„Éó„Ç∑„Éß„É≥„Ç≥„Éû„É≥„Éâ„É™„Çπ„Éà
declare -a OPTIONAL_COMMANDS=(
    "shellcheck:Shell script linter"
    "yamllint:YAML linter"
    "kubeval:Kubernetes manifest validator"
    "stern:Multi-pod log tailing"
    "k9s:Kubernetes TUI"
)

# „Éê„Éº„Ç∏„Éß„É≥Ë¶Å‰ª∂
declare -A VERSION_REQUIREMENTS=(
    ["kubectl"]="1.28.0"
    ["terraform"]="1.5.0"
    ["helm"]="3.12.0"
)

# „ÉÅ„Çß„ÉÉ„ÇØÈñ¢Êï∞
check_command() {
    local cmd=$1
    local description=$2
    local required=${3:-true}
    
    if command -v "$cmd" &>/dev/null; then
        local version=$(get_version "$cmd")
        log_info "‚úÖ $cmd: Found (${version:-unknown version}) - $description"
        
        # „Éê„Éº„Ç∏„Éß„É≥„ÉÅ„Çß„ÉÉ„ÇØ
        if [[ -n "${VERSION_REQUIREMENTS[$cmd]:-}" ]]; then
            if ! check_version "$cmd" "$version" "${VERSION_REQUIREMENTS[$cmd]}"; then
                log_warn "  ‚ö†Ô∏è  Version ${VERSION_REQUIREMENTS[$cmd]} or higher recommended"
            fi
        fi
        return 0
    else
        if [[ "$required" == "true" ]]; then
            log_error "‚ùå $cmd: Not found - $description"
            return 1
        else
            log_warn "‚ö†Ô∏è  $cmd: Not found (optional) - $description"
            return 0
        fi
    fi
}

# „Éê„Éº„Ç∏„Éß„É≥ÂèñÂæó
get_version() {
    local cmd=$1
    case "$cmd" in
        kubectl)
            kubectl version --client --short 2>/dev/null | grep -oP 'v[\d.]+' || echo ""
            ;;
        terraform)
            terraform version -json 2>/dev/null | jq -r '.terraform_version' || echo ""
            ;;
        helm)
            helm version --short 2>/dev/null | grep -oP 'v[\d.]+' || echo ""
            ;;
        *)
            echo ""
            ;;
    esac
}

# „Éê„Éº„Ç∏„Éß„É≥ÊØîËºÉ
check_version() {
    local cmd=$1
    local current=$2
    local required=$3
    
    # Simple version comparison (not perfect but good enough)
    if [[ "$current" > "$required" ]] || [[ "$current" == "$required" ]]; then
        return 0
    else
        return 1
    fi
}

# „Ç∑„Çπ„ÉÜ„É†Ë¶Å‰ª∂„ÉÅ„Çß„ÉÉ„ÇØ
check_system_requirements() {
    log_info "Checking system requirements..."
    
    # CPU cores
    local cpu_cores=$(nproc)
    if [[ $cpu_cores -ge 8 ]]; then
        log_info "‚úÖ CPU cores: $cpu_cores (minimum 8)"
    else
        log_warn "‚ö†Ô∏è  CPU cores: $cpu_cores (recommended 8+)"
    fi
    
    # Memory
    local mem_gb=$(free -g | awk '/^Mem:/{print $2}')
    if [[ $mem_gb -ge 32 ]]; then
        log_info "‚úÖ Memory: ${mem_gb}GB (minimum 32GB)"
    else
        log_warn "‚ö†Ô∏è  Memory: ${mem_gb}GB (recommended 32GB+)"
    fi
    
    # Disk space
    local disk_free=$(df -BG / | awk 'NR==2 {print $4}' | sed 's/G//')
    if [[ $disk_free -ge 100 ]]; then
        log_info "‚úÖ Free disk space: ${disk_free}GB (minimum 100GB)"
    else
        log_warn "‚ö†Ô∏è  Free disk space: ${disk_free}GB (recommended 100GB+)"
    fi
    
    # Virtualization support
    if grep -E '(vmx|svm)' /proc/cpuinfo &>/dev/null; then
        log_info "‚úÖ Virtualization: Supported"
    else
        log_error "‚ùå Virtualization: Not supported"
        return 1
    fi
}

# „É°„Ç§„É≥Âá¶ÁêÜ
main() {
    log_info "========================================="
    log_info "k8s_myHome Requirements Check"
    log_info "========================================="
    
    local failed=false
    
    # „Ç∑„Çπ„ÉÜ„É†Ë¶Å‰ª∂
    if ! check_system_requirements; then
        failed=true
    fi
    
    echo
    log_info "Checking required commands..."
    for cmd_desc in "${REQUIRED_COMMANDS[@]}"; do
        IFS=':' read -r cmd desc <<< "$cmd_desc"
        if ! check_command "$cmd" "$desc" true; then
            failed=true
        fi
    done
    
    echo
    log_info "Checking optional commands..."
    for cmd_desc in "${OPTIONAL_COMMANDS[@]}"; do
        IFS=':' read -r cmd desc <<< "$cmd_desc"
        check_command "$cmd" "$desc" false
    done
    
    echo
    log_info "========================================="
    if [[ "$failed" == "true" ]]; then
        log_error "‚ùå Some requirements are not met"
        log_info "Install missing dependencies with:"
        log_info "  Ubuntu/Debian: apt-get install <package>"
        log_info "  RHEL/CentOS: yum install <package>"
        exit 1
    else
        log_info "‚úÖ All requirements are met"
    fi
}

main "$@"
```

## üìã „ÉÅ„Çß„ÉÉ„ÇØ„É™„Çπ„ÉàÂΩ¢Âºè„ÅÆÂÆüË°åË®àÁîª

### „Çπ„ÉÜ„ÉÉ„Éó1: Âü∫Áõ§Ê∫ñÂÇô (10ÂàÜ)
```bash
# 1. „É≠„Ç∞„Éá„Ç£„É¨„ÇØ„Éà„É™‰ΩúÊàê
sudo mkdir -p /var/log/k8s-myhome
sudo chown $USER:$USER /var/log/k8s-myhome

# 2. „É©„Ç§„Éñ„É©„É™„Éá„Ç£„É¨„ÇØ„Éà„É™‰ΩúÊàê
mkdir -p automation/lib
mkdir -p automation/config

# 3. „Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó‰ΩúÊàê
tar -czf ~/k8s-myhome-backup-$(date +%Y%m%d-%H%M%S).tar.gz \
    --exclude='.git' --exclude='*.log' .
```

### „Çπ„ÉÜ„ÉÉ„Éó2: „Éï„Ç°„Ç§„É´‰ΩúÊàê (20ÂàÜ)
```bash
# 1. „Ç®„É©„Éº„Éè„É≥„Éâ„É©„Éº‰ΩúÊàê
vim automation/lib/error-handler.sh
# ‰∏äË®ò„ÅÆÂÜÖÂÆπ„Çí„Ç≥„Éî„ÉºÔºÜ„Éö„Éº„Çπ„Éà

# 2. „É≠„Ç¨„Éº‰ΩúÊàê
vim automation/lib/logger.sh
# ‰∏äË®ò„ÅÆÂÜÖÂÆπ„Çí„Ç≥„Éî„ÉºÔºÜ„Éö„Éº„Çπ„Éà

# 3. Ë®≠ÂÆö„Éï„Ç°„Ç§„É´‰ΩúÊàê
vim automation/config/environment.conf
# ‰∏äË®ò„ÅÆÂÜÖÂÆπ„Çí„Ç≥„Éî„ÉºÔºÜ„Éö„Éº„Çπ„Éà

# 4. ‰æùÂ≠òÈñ¢‰øÇ„ÉÅ„Çß„ÉÉ„Ç´„Éº‰ΩúÊàê
vim automation/scripts/check-requirements.sh
# ‰∏äË®ò„ÅÆÂÜÖÂÆπ„Çí„Ç≥„Éî„ÉºÔºÜ„Éö„Éº„Çπ„Éà

# 5. ÂÆüË°åÊ®©Èôê‰ªò‰∏é
chmod +x automation/lib/*.sh
chmod +x automation/scripts/check-requirements.sh
```

### „Çπ„ÉÜ„ÉÉ„Éó3: Êó¢Â≠ò„Éï„Ç°„Ç§„É´Êõ¥Êñ∞ (30ÂàÜ)
```bash
# 1. „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞ËøΩÂä†ÔºàÊú™ÂØæÂøú„ÅÆ6„Éï„Ç°„Ç§„É´Ôºâ
for file in automation/host-setup/setup-libvirt-sudo.sh \
           automation/scripts/common-validation.sh \
           automation/scripts/common-colors.sh \
           automation/scripts/argocd/github-auth-utils.sh \
           automation/scripts/common-ssh.sh \
           automation/scripts/common-sudo.sh; do
  sed -i '1a\\nset -euo pipefail' "$file"
done

# 2. ÂÖ±ÈÄö„É©„Ç§„Éñ„É©„É™„ÅÆ„Ç§„É≥„Éù„Éº„ÉàËøΩÂä†Ôºà‰∏ªË¶Å„Çπ„ÇØ„É™„Éó„ÉàÔºâ
for file in automation/platform/platform-deploy.sh \
           automation/infrastructure/clean-and-deploy.sh \
           automation/host-setup/setup-host.sh; do
  # „ÇΩ„Éº„ÇπË°å„ÇíËøΩÂä†
  sed -i '7i\source "$(dirname "$0")/../lib/logger.sh"' "$file"
  sed -i '8i\source "$(dirname "$0")/../lib/error-handler.sh"' "$file"
done
```

### „Çπ„ÉÜ„ÉÉ„Éó4: „ÉÜ„Çπ„Éà„Çπ„ÇØ„É™„Éó„Éà‰ΩúÊàê (15ÂàÜ)
```bash
# „ÉÜ„Çπ„Éà„Éá„Ç£„É¨„ÇØ„Éà„É™‰ΩúÊàê
mkdir -p test/{unit,integration,smoke}

# „Çπ„É¢„Éº„ÇØ„ÉÜ„Çπ„Éà‰ΩúÊàê
cat > test/smoke/basic-check.sh << 'EOF'
#!/bin/bash
set -euo pipefail

source "$(dirname "$0")/../../automation/lib/logger.sh"

log_info "Starting smoke tests..."

# 1. ‰æùÂ≠òÈñ¢‰øÇ„ÉÅ„Çß„ÉÉ„ÇØ
log_info "Checking dependencies..."
bash automation/scripts/check-requirements.sh

# 2. Ë®≠ÂÆö„Éï„Ç°„Ç§„É´Á¢∫Ë™ç
log_info "Checking configuration files..."
[[ -f automation/config/environment.conf ]] && log_info "‚úÖ environment.conf exists"
[[ -f automation/lib/logger.sh ]] && log_info "‚úÖ logger.sh exists"
[[ -f automation/lib/error-handler.sh ]] && log_info "‚úÖ error-handler.sh exists"

# 3. „Éç„ÉÉ„Éà„ÉØ„Éº„ÇØÁ¢∫Ë™ç
log_info "Checking network connectivity..."
for ip in 192.168.122.10 192.168.122.11 192.168.122.12; do
    if ping -c 1 -W 1 $ip &>/dev/null; then
        log_info "‚úÖ $ip is reachable"
    else
        log_warn "‚ö†Ô∏è  $ip is not reachable"
    fi
done

log_info "Smoke tests completed!"
EOF

chmod +x test/smoke/basic-check.sh
```

### „Çπ„ÉÜ„ÉÉ„Éó5: MakefileÊõ¥Êñ∞ (10ÂàÜ)
```makefile
# Makefile„Å´ËøΩÂä†
.PHONY: check test lint

check: ## Check system requirements
	@bash automation/scripts/check-requirements.sh

test: ## Run all tests
	@echo "Running smoke tests..."
	@bash test/smoke/basic-check.sh

lint: ## Lint shell scripts
	@echo "Linting shell scripts..."
	@find automation -name "*.sh" -exec shellcheck {} \; || true
	@echo "Linting YAML files..."
	@yamllint manifests/ || true

clean-logs: ## Clean log files
	@rm -f /var/log/k8s-myhome/*.log
	@echo "Log files cleaned"

backup: ## Create backup
	@tar -czf ../k8s-myhome-backup-$$(date +%Y%m%d-%H%M%S).tar.gz \
		--exclude='.git' --exclude='*.log' --exclude='tfplan' .
	@echo "Backup created"
```

## ‚úÖ ÂÆüË°åÁ¢∫Ë™ç„Ç≥„Éû„É≥„Éâ

```bash
# 1. Ë¶Å‰ª∂„ÉÅ„Çß„ÉÉ„ÇØ
bash automation/scripts/check-requirements.sh

# 2. „Çπ„É¢„Éº„ÇØ„ÉÜ„Çπ„Éà
bash test/smoke/basic-check.sh

# 3. „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞Á¢∫Ë™ç
grep -l "set -euo pipefail" automation/**/*.sh | wc -l
# Expected: 22 (ÂÖ®„Çπ„ÇØ„É™„Éó„Éà)

# 4. „É≠„Ç∞Ê©üËÉΩ„ÉÜ„Çπ„Éà
source automation/lib/logger.sh
log_info "Test message"
log_error "Error message"
log_debug "Debug message"  # LOG_LEVEL=DEBUGÊôÇ„ÅÆ„ÅøË°®Á§∫

# 5. „Ç®„É©„Éº„Éè„É≥„Éâ„É©„Éº„ÉÜ„Çπ„Éà
source automation/lib/error-handler.sh
retry_with_backoff 3 2 10 false  # Â§±Êïó„Çí„É™„Éà„É©„Ç§
run_with_timeout 5 sleep 10  # „Çø„Ç§„É†„Ç¢„Ç¶„Éà„ÉÜ„Çπ„Éà
```

## üìà ÊîπÂñÑÂäπÊûúÊ∏¨ÂÆö

| È†ÖÁõÆ | ÊîπÂñÑÂâç | ÊîπÂñÑÂæå | ÂäπÊûú |
|------|--------|--------|------|
| „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞ | 16/22 (73%) | 22/22 (100%) | +27% |
| „Éè„Éº„Éâ„Ç≥„Éº„ÉâÂÄ§ | 100+ | 0 | Ë®≠ÂÆö‰∏ÄÂÖÉÁÆ°ÁêÜ |
| „É≠„Ç∞Áµ±‰∏ÄÊÄß | „Å™„Åó | ÂÆåÂÖ®Áµ±‰∏Ä | „Éá„Éê„ÉÉ„Ç∞ÊôÇÈñì50%ÂâäÊ∏õ |
| ‰æùÂ≠òÈñ¢‰øÇ„ÉÅ„Çß„ÉÉ„ÇØ | „Å™„Åó | Ëá™Âãï | „Çª„ÉÉ„Éà„Ç¢„ÉÉ„ÉóÂ§±Êïó0% |
| „ÉÜ„Çπ„Éà„Ç´„Éê„É¨„ÉÉ„Ç∏ | 0% | Âü∫Êú¨„ÉÜ„Çπ„ÉàÂÆüË£Ö | Âü∫Áõ§ÂìÅË≥™Âêë‰∏ä |

## üöÄ Ê¨°„ÅÆ„Çπ„ÉÜ„ÉÉ„Éó

1. **CI/CDÂ∞éÂÖ•** (Week 2)
   - GitHub ActionsË®≠ÂÆö
   - Ëá™Âãï„ÉÜ„Çπ„ÉàÂÆüË°å
   - „Ç≥„Éº„ÉâÂìÅË≥™„ÉÅ„Çß„ÉÉ„ÇØ

2. **Áõ£Ë¶ñÂº∑Âåñ** (Week 3)
   - Prometheus/GrafanaË®≠ÂÆö
   - „Ç¢„É©„Éº„ÉàË®≠ÂÆö
   - „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ‰ΩúÊàê

3. **„Éâ„Ç≠„É•„É°„É≥„ÉàÊï¥ÂÇô** (Week 4)
   - API‰ªïÊßòÊõ∏
   - ÈÅãÁî®ÊâãÈ†ÜÊõ∏
   - „Éà„É©„Éñ„É´„Ç∑„É•„Éº„ÉÜ„Ç£„É≥„Ç∞„Ç¨„Ç§„Éâ

---

‰ΩúÊàêÊó•: 2025-01-26
ÂÆüË°å‰∫àÂÆö: Âç≥Â∫ß„Å´ÂÆüÊñΩÂèØËÉΩ
ÊâÄË¶ÅÊôÇÈñì: Á¥Ñ2ÊôÇÈñì